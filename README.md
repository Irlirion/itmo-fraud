# Разведочный анализ мошеннических транзакций (EDA)

## Описание проекта

В этом репозитории представлен разведочный анализ (EDA) транзакционных данных с целью выявления аномальных операций и признаков возможного мошенничества. Используя unsupervised-модели из библиотеки PyOD, мы генерируем скоринговые метрики, строим отчёты по «горячим точкам» и формулируем практические рекомендации для бизнеса.

## Данные

- **Объём:** 7 483 766 записей
- **Ключевые признаки:**

  - **Идентификаторы:** `transaction_id`, `customer_id`, `card_number`
  - **Время:** `timestamp`
  - **Торговцы:** `vendor_category`, `vendor_type`, `vendor`
  - **Суммы и валюта:** `amount`, `currency`
  - **Гео-информация:** `country`, `city`, `city_size`, `is_outside_home_country`
  - **Тип карты и канал оплаты:** `card_type`, `is_card_present`, `channel`, `device`
  - **Поведенческие метрики:** поле `last_hour_activity`, разбитое на пять числовых признаков
  - **Бинарные флаги:** `is_high_risk_vendor`, `is_weekend`, `is_fraud`

## Этапы анализа

1. **Предобработка данных и генерация признаков**

   - Логарифмическое преобразование суммы транзакции и поведенческих метрик.
   - Временные признаки: час суток, день недели, месяц, ночной/дневной период.
   - Ограничение категориальных признаков до топ‑K значений, остальные — в `OTHER`.
   - One-hot кодирование низкокардинальных категорий.

2. **Обучение unsupervised-моделей (PyOD)**

   - Детекторы: ECOD, IsolationForest.
   - Стандартизация скорингов, формирование итогового `anomaly_score` (среднее и максимум).
   - Калибровка порога под эмпирический уровень мошенничества (\~20 %).

3. **Оценка качества**

   - Precision/Recall/F1 на откалиброванном пороге: ≈0.62.
   - Средняя площадь PR‑кривой (AUC): ≈0.66.

4. **Анализ «горячих точек» (Hotspots)**

   - Срезы по категориям товаров, каналам, устройствам, странам, времени суток и т.д.
   - Расчёт `anomaly_lift` и `fraud_lift` для приоритезации зон риска.

5. **Поиск драйверов аномалий**

   - Корреляция числовых признаков с `anomaly_score`.
   - Средний uplift по категориям для ключевых признаков.

6. **Глубокий разбор**

   - Топ‑20 наиболее подозрительных мошеннических операций и ложных срабатываний.
   - Клиенты с наибольшим числом аномалий.

## Основные выводы

- **Модель в целом**: F1 ≈ 0.62, AUC(PR) ≈ 0.66 — хорошее разделение аномалий и нормальных операций.
- **Самые рискованные категории:** _Travel_ и _Entertainment_ показывают самый высокий uplift.
- **Каналы и устройства:** POS/чип-ридеры/NFC/магнитная полоса — экстремальные скоринги (lift > 5×). Мобильные приложения — умеренный риск, веб‑браузеры — ниже среднего.
- **География:** США — anomaly_lift ≈ 3× при низком fraud_lift; Мексика, Бразилия, Россия — anomaly_lift ≈ 1.3–1.4× и высокий fraud_lift.
- **Время суток:** пиковый риск в ночные часы (1–4 AM) — в 2.5–3× выше.
- **Тип карты:** Platinum Credit чуть более рискован, остальные — около среднего.
- **Размер города:** крупные города показывают значительный uplift (≈ 5×).

## Рекомендации для бизнеса

1. **Усиленные проверки для «горячих» сегментов**

   - _Travel_ через POS в США: добавить 2FA/3DS и velocity‑правила.
   - Mobile-транзакции в Мексике/Бразилии/России выше \$2000 — требовать дополнительную аутентификацию.

2. **Ночные лимиты и мониторинг**

   - Понизить порог аномалий с 1 AM до 5 AM или внедрить дополнительные проверки.

3. **Политика устройств**

   - Пересмотреть подход к чип-ридерам и NFC для новых клиентов.
   - Разделять браузерные и мобильные приложения при расчёте риск‑скоринга.

4. **Гео‑ограничения**

   - Для регионов с низким fraud_lift (Сингапур, Европа) устанавливать более мягкие правила по умолчанию.

5. **Оптимизация порогов**

   - Скорректировать threshold для мобильных каналов на основе ложных срабатываний.

6. **Расследование аккаунтов**

   - Проанализировать клиентов с > 1000 аномалий для выявления возможных компрометаций.

---

_Анализ выполнен с помощью Python, Pandas и PyOD._
